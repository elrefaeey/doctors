# ุฏููู ุญุฐู ุงููุณุชุฎุฏููู ๐๏ธ

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุฅููุงููุฉ ุญุฐู ุงููุณุชุฎุฏููู (ุฃุทุจุงุก ููุฑุถู) ูู ููุญุฉ ุชุญูู ุงููุณุคูู ูุน ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ ุจูู.

---

## ๐ฏ ุงูููุฒุงุช

### 1. ุญุฐู ุดุงูู ููุจูุงูุงุช
ุนูุฏ ุญุฐู ูุณุชุฎุฏูุ ูุชู ุญุฐู:

**ููุฃุทุจุงุก:**
- โ ุญุณุงุจ ุงููุณุชุฎุฏู ูู `users`
- โ ุจุฑููุงูู ุงูุทุจูุจ ูู `doctors`
- โ ุฌููุน ุงูููุงุนูุฏ ุงููุฑุชุจุทุฉ ุจุงูุทุจูุจ
- โ ุทูุจุงุช ุงูุงุดุชุฑุงูุงุช
- โ ุงููุญุงุฏุซุงุช
- โ ุงูุฅุดุนุงุฑุงุช

**ูููุฑุถู:**
- โ ุญุณุงุจ ุงููุณุชุฎุฏู ูู `users`
- โ ุฌููุน ุงูููุงุนูุฏ ุงููุฑุชุจุทุฉ ุจุงููุฑูุถ
- โ ุงููุญุงุฏุซุงุช
- โ ุงูุฅุดุนุงุฑุงุช
- โ ุงูุชููููุงุช ูุงููุฑุงุฌุนุงุช

### 2. ุญูุงูุฉ ูู ุงูุญุฐู ุงูุฎุงุทุฆ
- โ ูุง ูููู ูููุณุคูู ุญุฐู ุญุณุงุจู ุงูุฎุงุต
- โ๏ธ ุฑุณุงูุฉ ุชุฃููุฏ ูุจู ุงูุญุฐู
- ๐ ุนุฑุถ ูุงุฆูุฉ ุจูู ูุง ุณูุชู ุญุฐูู

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุงูุฎุทูุฉ 1: ุงููุตูู ููุณู ุงููุณุชุฎุฏููู
1. ุงูุชุญ ููุญุฉ ุงูุชุญูู
2. ุงุถุบุท ุนูู "ุงููุณุชุฎุฏููู" ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ
3. ุณุชุธูุฑ ูุงุฆูุฉ ุจุฌููุน ุงููุณุชุฎุฏููู

### ุงูุฎุทูุฉ 2: ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู
ูู ุฌุฏูู ุงููุณุชุฎุฏูููุ ุณุชุฌุฏ:
- ุงุณู ุงููุณุชุฎุฏู
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- ุงูุฏูุฑ (admin/doctor/patient)
- ุชุงุฑูุฎ ุงูุงูุถูุงู
- **ุฒุฑ "ุญุฐู"** (ุฃุญูุฑ)

### ุงูุฎุทูุฉ 3: ุชุฃููุฏ ุงูุญุฐู
ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุญุฐู"ุ ุณุชุธูุฑ ุฑุณุงูุฉ ุชุฃููุฏ:

```
โ๏ธ ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู [ุงูุทุจูุจ/ุงููุฑูุถ] "[ุงูุงุณู]"?

ุณูุชู ุญุฐู:
โข ุงูุญุณุงุจ
โข ุฌููุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ
โข ุงูููุงุนูุฏ
โข ุงููุญุงุฏุซุงุช
โข ุงูุฅุดุนุงุฑุงุช

โ๏ธ ูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู!
```

### ุงูุฎุทูุฉ 4: ุฅุชูุงู ุงูุญุฐู
- ุงุถุบุท "OK" ููุชุฃููุฏ
- ุณูุชู ุญุฐู ุงููุณุชุฎุฏู ูุฌููุน ุจูุงูุงุชู
- ุณุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ: `โ ุชู ุญุฐู [ุงูุฏูุฑ] "[ุงูุงุณู]" ุจูุฌุงุญ`

---

## ๐ก๏ธ ุงูุญูุงูุฉ ูุงูุฃูุงู

### 1. ููุน ุญุฐู ุงูุญุณุงุจ ุงูุฎุงุต
```typescript
if (userId === currentUser?.uid) {
  alert('โ ูุง ููููู ุญุฐู ุญุณุงุจู ุงูุฎุงุต!');
  return;
}
```

ุงูุฒุฑ ูููู ูุนุทู (disabled) ูุญุณุงุจู ุงูุฎุงุต:
- ููู ุฑูุงุฏู
- ูุคุดุฑ "not-allowed"
- ุฑุณุงูุฉ ุชูุถูุญูุฉ ุนูุฏ ุงูุชูุฑูุฑ

### 2. ุชุฃููุฏ ูุฒุฏูุฌ
- ุฑุณุงูุฉ ุชุฃููุฏ ูุจู ุงูุญุฐู
- ุนุฑุถ ุชูุงุตูู ูุง ุณูุชู ุญุฐูู
- ุชุญุฐูุฑ ุจุฃู ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู

### 3. ุญุฐู ูุชุณูุณู ุขูู
```typescript
// Delete in order:
1. User document
2. Doctor/Patient profile
3. Appointments
4. Chats
5. Notifications
6. Reviews (if patient)
7. Subscription requests (if doctor)
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุฒุฑ ุงูุญุฐู
**ูููุณุชุฎุฏููู ุงูุขุฎุฑูู:**
```
[๐๏ธ ุญุฐู]
- ููู: ุฃุญูุฑ ูุงุชุญ
- ุนูุฏ ุงูุชูุฑูุฑ: ุฃุญูุฑ ุบุงูู + ูุต ุฃุจูุถ
- ุฃููููุฉ: Trash2
```

**ูุญุณุงุจู ุงูุฎุงุต:**
```
[๐๏ธ ุญุฐู]
- ููู: ุฑูุงุฏู
- ูุนุทู (disabled)
- ุฑุณุงูุฉ: "ูุง ููููู ุญุฐู ุญุณุงุจู ุงูุฎุงุต"
```

### ุฑุณุงุฆู ุงููุฌุงุญ
```
โ ุชู ุญุฐู ุงูุทุจูุจ "ุฏ. ุฃุญูุฏ ูุญูุฏ" ุจูุฌุงุญ
โ ุชู ุญุฐู ุงููุฑูุถ "ูุญูุฏ ุนูู" ุจูุฌุงุญ
```

### ุฑุณุงุฆู ุงูุฎุทุฃ
```
โ ูุง ููููู ุญุฐู ุญุณุงุจู ุงูุฎุงุต!
โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญุฐู: [ุชูุงุตูู ุงูุฎุทุฃ]
```

---

## ๐ง ุงูููุฏ ุงูุชููู

### Function ุงูุญุฐู ูู firebaseService.ts
```typescript
export const deleteUser = async (userId: string, userRole: string): Promise<void> => {
  // Delete user document
  await deleteDoc(doc(db, 'users', userId));

  // Delete role-specific data
  if (userRole === 'doctor') {
    // Delete doctor profile, appointments, subscription requests
  }
  
  if (userRole === 'patient') {
    // Delete patient appointments, reviews
  }

  // Delete common data (chats, notifications)
}
```

### Handler ูู AdminDashboard.tsx
```typescript
const handleDeleteUser = async (userId: string, userName: string, userRole: string) => {
  // Confirm deletion
  if (!confirm(...)) return;

  // Prevent self-deletion
  if (userId === currentUser?.uid) {
    alert('โ ูุง ููููู ุญุฐู ุญุณุงุจู ุงูุฎุงุต!');
    return;
  }

  // Delete user
  await deleteUser(userId, userRole);
  
  // Refresh data
  await fetchData();
}
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. ุงููุณุฎ ุงูุงุญุชูุงุทู
ูุจู ุญุฐู ุฃู ูุณุชุฎุฏู ููู:
- โ ุชุฃูุฏ ูู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูุจูุงูุงุช
- โ ุฑุงุฌุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ
- โ ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ููุงุนูุฏ ูุดุทุฉ

### 2. ุงูุญุฐู ุงูููุงุฆู
- โ๏ธ ุงูุญุฐู ููุงุฆู ููุง ูููู ุงูุชุฑุงุฌุน ุนูู
- โ๏ธ ูุง ุชูุฌุฏ ุณูุฉ ูุญุฐููุงุช
- โ๏ธ ุฌููุน ุงูุจูุงูุงุช ุชูุญุฐู ููุฑุงู

### 3. Firebase Authentication
**ููุงุญุธุฉ:** ูุฐุง ุงูููุฏ ูุญุฐู ุงูุจูุงูุงุช ูู Firestore ููุท.

ูุญุฐู ุงููุณุชุฎุฏู ูู Firebase Authentication ุฃูุถุงูุ ุชุญุชุงุฌ:
- Firebase Admin SDK (ูู Backend)
- ุฃู Cloud Function
- ุฃู Firebase Extensions

**ูุซุงู (Cloud Function):**
```javascript
exports.deleteUser = functions.https.onCall(async (data, context) => {
  // Check if admin
  if (!context.auth || !isAdmin(context.auth.uid)) {
    throw new functions.https.HttpsError('permission-denied');
  }

  // Delete from Authentication
  await admin.auth().deleteUser(data.userId);
  
  // Delete from Firestore (call existing function)
  // ...
});
```

---

## ๐ ุฅุญุตุงุฆูุงุช

ุจุนุฏ ุงูุญุฐูุ ุณูุชู ุชุญุฏูุซ:
- โ ุนุฏุฏ ุงููุณุชุฎุฏููู ูู ุงููุธุฑุฉ ุงูุนุงูุฉ
- โ ุนุฏุฏ ุงูุฃุทุจุงุก (ุฅุฐุง ูุงู ุทุจูุจ)
- โ ูุงุฆูุฉ ุงููุณุชุฎุฏููู

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุธูุฑ ุฒุฑ ุงูุญุฐู
**ุงูุญู:**
- ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู ููุณุคูู
- ุชุญุฏูุซ ุงูุตูุญุฉ (F5)

### ุงููุดููุฉ: ุฎุทุฃ "Permission Denied"
**ุงูุญู:**
- ุชุญูู ูู ููุงุนุฏ Firestore
- ุชุฃูุฏ ูู ุฃู ุงููุณุคูู ูุฏูู ุตูุงุญูุฉ `delete`

```javascript
match /users/{userId} {
  allow delete: if isAdmin();
}
```

### ุงููุดููุฉ: ูู ูุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช
**ุงูุญู:**
- ุชุญูู ูู Firebase Console
- ุงุจุญุซ ุนู ุงูุจูุงูุงุช ุงููุชุจููุฉ ูุฏููุงู
- ุชุญูู ูู ุงูู console logs

---

## โ ูุงุฆูุฉ ุงูุชุญูู

ูุจู ุญุฐู ูุณุชุฎุฏู:
- [ ] ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุญุฐูุ
- [ ] ูู ุชู ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉุ
- [ ] ูู ุฑุงุฌุนุช ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉุ
- [ ] ูู ุฃุจูุบุช ุงููุณุชุฎุฏู (ุฅุฐุง ูุฒู ุงูุฃูุฑ)ุ
- [ ] ูู ุชุญููุช ูู ุนุฏู ูุฌูุฏ ููุงุนูุฏ ูุดุทุฉุ

ุจุนุฏ ุงูุญุฐู:
- [ ] ุชุญูู ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุช
- [ ] ุชุญูู ูู ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
- [ ] ุณุฌู ุนูููุฉ ุงูุญุฐู (ูููุฑุงุฌุนุฉ)

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:
1. ุชุญูู ูู console logs
2. ุฑุงุฌุน Firebase Console
3. ุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ
